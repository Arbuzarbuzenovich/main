@startuml Pharmacy App Activity Diagram

skinparam activityBackgroundColor White
skinparam activityBorderColor Black
skinparam activityDiamondBackgroundColor White
skinparam activityDiamondBorderColor Black

title Диаграмма активности: Работа с мобильным приложением аптечной сети

start

:Пользователь открывает приложение;

if (Пользователь авторизован?) then (нет)
  :Отображение сообщения об ошибке;
  stop
else (да)
  :Отобразить главную страницу;
endif

partition "Поиск и заказ лекарств" {
  :Выбрать "Поиск лекарств";
  :Ввести название препарата;
  :Отобразить результаты поиска;
  
  if (Выбран товар?) then (нет)
    :Вернуться к поиску;
  else (да)
    :Просмотр информации о товаре;
    :Проверка наличия в аптеках;
    
    if (Товар в наличии?) then (нет)
      :Сообщение "Товара нет в наличии";
    else (да)
      :Добавить в корзину;
      :Перейти к оформлению заказа;
    endif
  endif
}

partition "Просмотр заказов" {
  :Выбрать "Мои заказы";
  :Запрос данных о заказах;
  :Отобразить историю заказов;
  :Показать статус активных заказов;
}

partition "Управление профилем" {
  :Выбрать "Профиль";
  :Выбрать действие;
  
  if (Какое действие?) then (Просмотр бонусов)
    :Запрос баланса бонусов;
    :Отобразить бонусы;
  elseif (Настройки) then
    :Изменить язык интерфейса;
    :Изменить контактные данные;
  elseif (Электронные рецепты) then
    :Просмотр рецептов;
    :Загрузка нового рецепта;
  endif
}

partition "Оформление заказа" {
  :Выбрать "Корзина";
  :Просмотр содержимого корзины;
  
  if (Корзина пуста?) then (да)
    :Сообщение "Корзина пуста";
    stop
  else (нет)
    :Выбрать способ получения;
    
    if (Способ получения?) then (Самовывоз)
      :Выбрать аптеку на карте;
    elseif (Доставка) then
      :Ввести адрес доставки;
    endif
    
    :Выбрать способ оплаты;
    
    if (Оплата онлайн?) then (да)
      :Ввод данных карты;
      :Обработка платежа;
      
      if (Платёж успешен?) then (нет)
        :Сообщение об ошибке оплаты;
        stop
      else (да)
        :Подтверждение оплаты;
      endif
    else (При получении)
      :Резервирование товаров;
    endif
    
    :Создание заказа;
    :Отправка уведомления;
    :Отобразить подтверждение заказа;
  endif
}

stop

@enduml